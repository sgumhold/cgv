<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cgv: VR support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cgv
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('VR.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">VR support </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="VRIntro"></a>
Introduction to VR Support in CGV Framework</h1>
<p>The VR support distributed over several libraries and plugins. The following list gives a brief overview:</p>
<ul>
<li><p class="startli"><b><code>&lt;cgv/libs/vr&gt;</code></b></p>
<p class="startli">basic interface to implement vr apps that is independent of cgv framework and specific vr api. It builds on the concept of a driver that provides instances of vr kits and supports calibration through a calibration matrix. There can be several drivers in use at the same time. A simple registry is used to manage drivers and vr kits. The vr_kit class provides access to the display and the controllers with a simple state polling api.</p>
</li>
<li><p class="startli"><b><code>&lt;cgv/3rd/openvr&gt;</code></b></p>
<p class="startli">a copy of the openvr library such that it compiles within the build system of the framework. There is one change to support compilation with unicode characters under windows.</p>
</li>
<li><p class="startli"><b><code>&lt;cgv/plugins/openvr_driver&gt;</code></b></p>
<p class="startli">implements the vr interface for the openvr api. The only thing that needs to be done is to add the <code>openvr_driver</code> plugin as dependent project in the .pj-file.</p>
<p class="startli">Currently, under windows steam vr changes the framebuffer type to non sRGB. Then the gamma correction needs to be set to 1.0f with <a class="el" href="classcgv_1_1render_1_1context.html#ade244b3b056257e5350de3d07f40560c" title="set the current per channel gamma values to single value">cgv::render::context::set_gamma</a>(1.0f) instead of the standard value of 2.2f. As this happens even if no vr device is attached.</p>
<p class="startli">One can define the option <code>CGV_OPTIONS=NO_OPENVR</code> when one is not using a vr kit. Then openvr is not initialized by the openvr driver.</p>
</li>
<li><p class="startli"><b><code>&lt;cgv/test/vr&gt;</code></b></p>
<p class="startli">Plugin that implements a vr driver emulating one or several vr kits that can be controlled with keyboard. More information on its usage can be found in <a class="el" href="VR.html#VREmul">Emulation of Virtual VR Kits</a>.</p>
</li>
<li><p class="startli"><b><code>&lt;cgv/plugins/cg_vr&gt;</code></b></p>
<p class="startli">This plugin connects <b><code>&lt;cgv/libs/vr&gt;</code></b> to <b><code>&lt;cgv/gui&gt;</code></b> by translating changes in the vr kit states into events dispatched though the <a class="el" href="classcgv_1_1gui_1_1event__handler.html" title="interface for all classes that want to receive events">cgv::gui::event_handler</a> interface. The central class for this is <a class="el" href="classcgv_1_1gui_1_1vr__server.html" title="server for vr events">cgv::gui::vr_server</a>. Please see its documentation. VR events are declared in the cgv/plugins/cg_vr/vr_events.h header and marked with the <a class="el" href="namespacecgv_1_1gui.html#ae38dbc5a70de43f0304bf39dcf21175aa62bd9726fe3f52c40bade752ad5451c8" title="whether event is from VR kit">cgv::gui::EF_VR</a> event flag.</p>
</li>
<li><p class="startli"><b><code>&lt;cgv/plugins/crg_vr_view&gt;</code></b></p>
<p class="startli">This plugin extends the stereo_view_interactor class of the crg_stereo_view plugin with vr support to the <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> class. It connects to the on_device_change signal of the <a class="el" href="classcgv_1_1gui_1_1vr__server.html" title="server for vr events">cgv::gui::vr_server</a> singleton and keeps track of device changes in order to initialize and destruct their framebuffers in the opengl context of the <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a>.</p>
<p class="startli">It keeps a current vr_kit which can be selected with <b><code>{Ctrl-Alt-0..3}</code></b> or through the user interface. It can render vr kits with meshes and or with spheres representing eyes and controllers. If the meshes are not provided in the <code>CGV_DATA</code> path and in Debug configuration the sphere rendering is the default.</p>
<p class="startli">Furthermore, the action zone boundaries can be rendered as a dashed fence. It can also debug all emitted vr events in the text console window. The <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> manages its own view which can be controlled with the mouse as in the case of the stereo_view_interactor.</p>
<p class="startli">Further rendering passes are issued to render from the views of the hmds of the present vr kits. The current vr kit states are queried with <code>pose_query=2</code> for the currently selected vr kit and with <code>pose_query=1</code> for the others. The rendered vr views are submitted to the hmds and can optionally blit in the current framebuffer. The queried states are dispatched in the <a class="el" href="classcgv_1_1gui_1_1vr__server.html" title="server for vr events">cgv::gui::vr_server</a> singleton with the <a class="el" href="classcgv_1_1gui_1_1vr__server.html#ae637df03a763ffafc7c94fde5523ce7b" title="in case the current vr state of a kit had been queried somewhere else, use this function to communica...">cgv::gui::vr_server::check_new_state()</a> function such that you should use the second or third option descripted in the detailed documentation of the <a class="el" href="classcgv_1_1gui_1_1vr__server.html" title="server for vr events">cgv::gui::vr_server</a>.</p>
<p class="startli">The <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> provides the following configuration methods:</p><ul>
<li><a class="el" href="classvr__view__interactor.html#adf4e1b4102711989f4218ba89d4add68" title="set the event type flags of to be emitted events">vr_view_interactor::set_event_type_flags()</a> ... to specify which events should be sent to the event handles. By default all events are sent.</li>
<li><a class="el" href="classvr__view__interactor.html#a3a61d0219ff07ca030b7e04a79c48130" title="set whether vr events should be printed to the console window">vr_view_interactor::enable_vr_event_debugging()</a> ... allows to toggle debugging of vr events</li>
<li>and several rendering configuration methods as documented in the <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> class</li>
</ul>
<p class="startli">All vr events provide information on the state of the vr_kit that generated the event. Further convenience functions that can be called also during the draw process are</p><ul>
<li><a class="el" href="classvr__view__interactor.html#ae071626af3de2f35c9537ba2f2b12ad5" title="return a pointer to the state of the current vr kit">vr_view_interactor::get_current_vr_state()</a> ... access to the vr_state of the active vr_kit</li>
<li><a class="el" href="classvr__view__interactor.html#aaed3b229921b8f5e7d5c06670918f9fc" title="query view direction of a vr kit">vr_view_interactor::get_view_dir_of_kit()</a>, <a class="el" href="classvr__view__interactor.html#a52ea2c50a1d56304ebe0adfcb109e8f2" title="query view up direction of a vr kit">vr_view_interactor::get_view_up_dir_of_kit()</a>, <a class="el" href="classvr__view__interactor.html#a442bccf7e301566eff517a9384710f21" title="query the eye position of a vr kit.">vr_view_interactor::get_eye_of_kit()</a> ... to access the view information of the attached vr_kits</li>
</ul>
</li>
<li><p class="startli"><b><code>&lt;cgv/plugins/vr_test&gt;</code></b></p>
<p class="startli">an advanced example of how to use the vr in the cgv framework that includes picking and grabbing of boxes through controller rays and a touch of the controller touchpad, offline text rendering to display an information board and rendering a polygonal mesh (currently the file name is hard coded and needs to be changed in the code to some local meshes)</p>
</li>
</ul>
<h1><a class="anchor" id="VRCalib"></a>
Calibration of Tracking System</h1>
<p>Each vr driver has an optional 3x4 matrix to transform all tracked poses. The transformation can be enabled with <a class="el" href="classvr_1_1vr__driver.html#ad745836daa554cccb87a01dc02d90c21" title="enable use of calibration transformation">vr::vr_driver::enable_calibration_transformation()</a> and disabled with <a class="el" href="classvr_1_1vr__driver.html#ad745836daa554cccb87a01dc02d90c21" title="enable use of calibration transformation">vr::vr_driver::enable_calibration_transformation()</a>. One can query the current transformation matrix with <a class="el" href="classvr_1_1vr__driver.html#a45c91728c7a500f3b6a7f0f732bf340b" title="read access to calibration transformation stored as 3x4-matrix">vr::vr_driver::put_calibration_transformation()</a>. Setting the calibration matrix is restricted to classes derived from <a class="el" href="classvr_1_1vr__calibration__base.html" title="base class with write access to driver calibration matrix">vr::vr_calibration_base</a>.</p>
<p>Typically, one does not deal with the calibration matrix directly, but uses the functionality implemented in <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a>. To define the calibration matrix in a way that the coordinates of the tracking system align with the physical world, one follows the following procedure:</p><ol type="1">
<li>find a point on a horizontal surface in physical space (table or ground) which has a corresponding point in your virtual scene</li>
<li>place a controller upside on the horizontal surface pointing in a direction aligned with a physical edge that corresponds to a virtual edge.</li>
<li>single click corresponding point in your virtual scene, such that the focus point of <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> is set to the clicked point</li>
<li>press <b><code>{Shift-Ctrl-0..3}</code></b> with the number key corresponding to the controller index (you can also use a tracker for calibration). Then <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> sets its calibration location vectors and update and enable the calibration matrix of the current vr driver such that tracked position of the calibrated controller matches the position of the focus point in the virtual scene</li>
<li>to adjust the rotation go to the <b><code>[vr interactor]</code></b> tab and open the <b><code>[VR calibration]</code></b> UI node. Adjust the <b><code>[tracking_rotation]</code></b> slider to match the 2D rotation of the virtual controller and the physical controller. The <a class="el" href="classvr__view__interactor.html" title="extends the stereo view interactor for vr support">vr_view_interactor</a> always updates the driver calibration matrix when this rotation angle is changed.</li>
<li>When you are done with calibration, you can save the calibration to a file by pressing the save icon of <b><code>[calibration_file_path]</code></b>. Please choose <code>.cal</code> as extension.</li>
</ol>
<p>To automatically read your calibration at program start add the following line to your <code>.pj</code>-file: </p><pre class="fragment">type(vr_view_interactor):calibration_file_path="D:/develop/table.cal"
</pre> <h1><a class="anchor" id="VREmul"></a>
Emulation of Virtual VR Kits</h1>
<p>When you add the plugin <b><code>&lt;<a class="el" href="vr__emulator_8pj_source.html">cgv/test/vr/vr_emulator.pj</a>&gt;</code></b> to the list of dependent projects in your <code>.pj</code>-file: </p><pre class="fragment">addProjectDeps = [ ... , "vr_emulator", ... ];
addProjectDirs = [ ... , CGV_DIR."/test/vr", ... ];
</pre><p> the plugin automatically creates an instance of the <code><a class="el" href="classvr__emulator.html">vr_emulator</a></code> class that generates a new tabgroup in the UI and handles keyboard shortcuts. You can configure the <code><a class="el" href="classvr__emulator.html">vr_emulator</a></code> instance in your configuration file. See <code><a class="el" href="test_2vr_2config_8def_source.html">cgv/test/vr/config.def</a></code> for a documented list of possible configurations, which include creation of vr kits at program start.</p>
<p>After program start you can create a new vr_kit with the shortcut <b><code>{Ctrl-Alt-N}</code></b>.</p>
<p>Each vr_kit is controlled by a very simple model of the human body that can move and turn, bend the hip forward/backward, turn the head left or right (yaw) and move each hand in a local 3D coordinate system with origin in the corresponding shoulder and oriented as the hip coordinate system.</p>
<p>To control the body model the <a class="el" href="classvr__emulator.html">vr_emulator</a> allows to use the keys <b><code>{0}</code></b>, <b><code>{1}</code></b>, <b><code>{2}</code></b>, and <b><code>{3}</code></b> as modifier keys to control up to 4 vr_kits with the keyboard. The arrow keys allow to move and rotate. <b><code>{PgUp}</code></b> and <b><code>{PgDn}</code></b> control hip bending and <b><code>{Home}</code></b> and <b><code>{End}</code></b> yawing.</p>
<p>The controller keys of each kit are can be toggled with the following keys pressed while holding the modifier key (<b><code>{0 .. 3}</code></b>) of the vr kit:</p>
<ul>
<li><b><code>{W}</code></b> ... left menu button</li>
<li><b><code>{X}</code></b> ... left grip button</li>
<li><b><code>{Q}</code></b> ... left system button</li>
<li><b><code>{E}</code></b> ... left A button</li>
<li><b><code>{A}</code></b> ... left pad touch</li>
<li><b><code>{S}</code></b> ... left pad press</li>
<li><b><code>{I}</code></b> ... right menu button</li>
<li><b><code>{O}</code></b> ... right grip button</li>
<li><b><code>{U}</code></b> ... right system button</li>
<li><b><code>{B}</code></b> ... right A button</li>
<li><b><code>{J}</code></b> ... right pad press</li>
<li><b><code>{K}</code></b> ... right pad touch</li>
</ul>
<p>To make sure that all keys are dispatched by <code><a class="el" href="classvr__emulator.html">vr_emulator</a></code>, select it for keyboard focus with the tab key or by selecting its tab group.</p>
<h1><a class="anchor" id="VRApp"></a>
Application Development</h1>
<p>The most convenient approach to use vr in a cgv application is through the plugin <b><code>&lt;cgv/plugins/crg_vr_view&gt;</code></b> which replaces the plugin <b><code>&lt;cgv/plugins/crg_stereo_view&gt;</code></b> of a none vr application. To get access to vr kits you need the plugin <b><code>&lt;cgv/plugins/openvr_driver&gt;</code></b> to use openvr and or <b><code>&lt;cgv/test/vr_emulator&gt;</code></b> to use the vr emulation. Finally, you need to include the libraries <b><code>&lt;cgv/libs/vr&gt;</code></b> and <b><code>&lt;cgv/libs/cg_vr&gt;</code></b>.</p>
<p>To implement your application main class, e.g. vr_viewer, derive it as usual from <a class="el" href="classcgv_1_1base_1_1node.html" title="The node class keeps a pointer to its parent.">cgv::base::node</a>, <a class="el" href="classcgv_1_1render_1_1drawable.html" title="base class for all drawables, which is independent of the used rendering API.">cgv::render::drawable</a>, <a class="el" href="classcgv_1_1gui_1_1event__handler.html" title="interface for all classes that want to receive events">cgv::gui::event_handler</a>, and optionally from <a class="el" href="classcgv_1_1gui_1_1provider.html" title="derive from this class to provide a gui to the current viewer">cgv::gui::provider</a> if you want to provide a classic UI.</p>
<p>You typically enable and configure VR in your drawable::init method by connecting the <a class="el" href="classcgv_1_1gui_1_1vr__server.html" title="server for vr events">cgv::gui::vr_server</a> singleton to the event processing of the main window and telling the cgv::render::vr_view_interactor instance which vr events should be generated and how the main rendering window should be configured. In <b><code>&lt;cgv/plugins/vr_test&gt;</code></b> you can find an example where the following code fragments are important: </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line"><span class="preprocessor">#include &lt;cg_vr/vr_server.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vr_view_interactor.h&gt;</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="classvr__test.html#aeac0e0a250489daf6b9eabc8483573da">vr_test::init</a>(<a class="code" href="classcgv_1_1render_1_1context.html">cgv::render::context</a>&amp; ctx)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespacecgv_1_1gui.html#ae0975ed87d1a75c654c88184288a6543">cgv::gui::connect_vr_server</a>(<span class="keyword">true</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">auto</span> <a class="code" href="namespacecgv_1_1gui.html#aceb07fba6859effc2353f70788dd7f9b">view_ptr</a> = <a class="code" href="classcgv_1_1render_1_1drawable.html#ad53ea85f6e09e4e2886250600a70742d">find_view_as_node</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (view_ptr) {</div>
<div class="line">        vr_view_ptr = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classvr__view__interactor.html">vr_view_interactor</a>*<span class="keyword">&gt;</span>(<a class="code" href="namespacecgv_1_1gui.html#aceb07fba6859effc2353f70788dd7f9b">view_ptr</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (vr_view_ptr) {</div>
<div class="line">            vr_view_ptr-&gt;<a class="code" href="classvr__view__interactor.html#adf4e1b4102711989f4218ba89d4add68">set_event_type_flags</a>(</div>
<div class="line">                <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cd">cgv::gui::VREventTypeFlags</a>(</div>
<div class="line">                    <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdad51d9f77f004dc9dba700ed831a2b135">cgv::gui::VRE_DEVICE</a> + <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdab531b503b809c0b17a03c7eb34ba8500">cgv::gui::VRE_STATUS</a> +</div>
<div class="line">                    <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdaa52da604bb760364d15d1f271264ccf5">cgv::gui::VRE_KEY</a> + <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda43c91e72fb5c679241175baf085e3257">cgv::gui::VRE_ONE_AXIS</a> + <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda329677e0c4e8d6d539e287c30e713fd8">cgv::gui::VRE_TWO_AXES</a> +</div>
<div class="line">                    <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda2e30c55db8bc2f29584595c3b2e09cdb">cgv::gui::VRE_ONE_AXIS_GENERATES_KEY</a> + <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdabc2660a06e4491252aa2ae75b2d5aad8">cgv::gui::VRE_TWO_AXES_GENERATES_DPAD</a> +</div>
<div class="line">                    <a class="code" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda111403896cb8142d28d52614b2470dab">cgv::gui::VRE_POSE</a>));</div>
<div class="line">            vr_view_ptr-&gt;<a class="code" href="classvr__view__interactor.html#a3a61d0219ff07ca030b7e04a79c48130">enable_vr_event_debugging</a>(<span class="keyword">true</span>);</div>
<div class="line">            vr_view_ptr-&gt;<a class="code" href="classvr__view__interactor.html#aa1660d9fb86240e1670931efa0f188d2">draw_action_zone</a>(<span class="keyword">false</span>);</div>
<div class="line">            vr_view_ptr-&gt;<a class="code" href="classvr__view__interactor.html#a2d62470d2b668f2b0d063719f184e7f1">draw_vr_kits</a>(<span class="keyword">true</span>);</div>
<div class="line">            vr_view_ptr-&gt;<a class="code" href="classvr__view__interactor.html#a9aa99ca871b0e271c9a0f18edc8cdcea">enable_blit_vr_views</a>(<span class="keyword">true</span>);</div>
<div class="line">            vr_view_ptr-&gt;<a class="code" href="classvr__view__interactor.html#a201288324dd06532371f841356efe92d">set_blit_vr_view_width</a>(200);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclasscgv_1_1render_1_1context_html"><div class="ttname"><a href="classcgv_1_1render_1_1context.html">cgv::render::context</a></div><div class="ttdoc">base class for all drawables, which is independent of the used rendering API.</div><div class="ttdef"><b>Definition:</b> <a href="context_8h_source.html#l00586">context.h:587</a></div></div>
<div class="ttc" id="aclasscgv_1_1render_1_1drawable_html_ad53ea85f6e09e4e2886250600a70742d"><div class="ttname"><a href="classcgv_1_1render_1_1drawable.html#ad53ea85f6e09e4e2886250600a70742d">cgv::render::drawable::find_view_as_node</a></div><div class="ttdeci">view * find_view_as_node(size_t view_idx=0) const</div><div class="ttdoc">convenience function to find the view control in the current hierarchy</div><div class="ttdef"><b>Definition:</b> <a href="drawable_8cxx_source.html#l00049">drawable.cxx:49</a></div></div>
<div class="ttc" id="aclassvr__test_html_aeac0e0a250489daf6b9eabc8483573da"><div class="ttname"><a href="classvr__test.html#aeac0e0a250489daf6b9eabc8483573da">vr_test::init</a></div><div class="ttdeci">bool init(cgv::render::context &amp;ctx)</div><div class="ttdoc">this method is called after creation or recreation of the context, return whether all necessary funct...</div><div class="ttdef"><b>Definition:</b> <a href="vr__test_8cxx_source.html#l00457">vr_test.cxx:457</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html"><div class="ttname"><a href="classvr__view__interactor.html">vr_view_interactor</a></div><div class="ttdoc">extends the stereo view interactor for vr support</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8h_source.html#l00068">vr_view_interactor.h:69</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html_a201288324dd06532371f841356efe92d"><div class="ttname"><a href="classvr__view__interactor.html#a201288324dd06532371f841356efe92d">vr_view_interactor::set_blit_vr_view_width</a></div><div class="ttdeci">void set_blit_vr_view_width(int width)</div><div class="ttdoc">set the width with which vr views are blit</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8cxx_source.html#l00108">vr_view_interactor.cxx:108</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html_a2d62470d2b668f2b0d063719f184e7f1"><div class="ttname"><a href="classvr__view__interactor.html#a2d62470d2b668f2b0d063719f184e7f1">vr_view_interactor::draw_vr_kits</a></div><div class="ttdeci">void draw_vr_kits(bool do_draw)</div><div class="ttdoc">set whether to draw vr kits</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8cxx_source.html#l00084">vr_view_interactor.cxx:84</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html_a3a61d0219ff07ca030b7e04a79c48130"><div class="ttname"><a href="classvr__view__interactor.html#a3a61d0219ff07ca030b7e04a79c48130">vr_view_interactor::enable_vr_event_debugging</a></div><div class="ttdeci">void enable_vr_event_debugging(bool enable=true)</div><div class="ttdoc">set whether vr events should be printed to the console window</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8cxx_source.html#l00066">vr_view_interactor.cxx:66</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html_a9aa99ca871b0e271c9a0f18edc8cdcea"><div class="ttname"><a href="classvr__view__interactor.html#a9aa99ca871b0e271c9a0f18edc8cdcea">vr_view_interactor::enable_blit_vr_views</a></div><div class="ttdeci">void enable_blit_vr_views(bool enable)</div><div class="ttdoc">enable vr view blitting</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8cxx_source.html#l00100">vr_view_interactor.cxx:100</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html_aa1660d9fb86240e1670931efa0f188d2"><div class="ttname"><a href="classvr__view__interactor.html#aa1660d9fb86240e1670931efa0f188d2">vr_view_interactor::draw_action_zone</a></div><div class="ttdeci">void draw_action_zone(bool do_draw)</div><div class="ttdoc">whether to draw action zone</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8cxx_source.html#l00092">vr_view_interactor.cxx:92</a></div></div>
<div class="ttc" id="aclassvr__view__interactor_html_adf4e1b4102711989f4218ba89d4add68"><div class="ttname"><a href="classvr__view__interactor.html#adf4e1b4102711989f4218ba89d4add68">vr_view_interactor::set_event_type_flags</a></div><div class="ttdeci">void set_event_type_flags(cgv::gui::VREventTypeFlags flags)</div><div class="ttdoc">set the event type flags of to be emitted events</div><div class="ttdef"><b>Definition:</b> <a href="vr__view__interactor_8cxx_source.html#l00167">vr_view_interactor.cxx:167</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_aceb07fba6859effc2353f70788dd7f9b"><div class="ttname"><a href="namespacecgv_1_1gui.html#aceb07fba6859effc2353f70788dd7f9b">cgv::gui::view_ptr</a></div><div class="ttdeci">data::ref_ptr&lt; abst_view &gt; view_ptr</div><div class="ttdoc">ref counted pointer to abst view</div><div class="ttdef"><b>Definition:</b> <a href="gui_2view_8h_source.html#l00036">view.h:36</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cd"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cd">cgv::gui::VREventTypeFlags</a></div><div class="ttdeci">VREventTypeFlags</div><div class="ttdoc">flags to define which events should be generated by server</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00026">vr_server.h:27</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cda111403896cb8142d28d52614b2470dab"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda111403896cb8142d28d52614b2470dab">cgv::gui::VRE_POSE</a></div><div class="ttdeci">@ VRE_POSE</div><div class="ttdoc">pose events</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00036">vr_server.h:36</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cda2e30c55db8bc2f29584595c3b2e09cdb"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda2e30c55db8bc2f29584595c3b2e09cdb">cgv::gui::VRE_ONE_AXIS_GENERATES_KEY</a></div><div class="ttdeci">@ VRE_ONE_AXIS_GENERATES_KEY</div><div class="ttdoc">whether one axis events should generate a key event when passing inputs threshold value</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00034">vr_server.h:34</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cda329677e0c4e8d6d539e287c30e713fd8"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda329677e0c4e8d6d539e287c30e713fd8">cgv::gui::VRE_TWO_AXES</a></div><div class="ttdeci">@ VRE_TWO_AXES</div><div class="ttdoc">pad / stick events</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00033">vr_server.h:33</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cda43c91e72fb5c679241175baf085e3257"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cda43c91e72fb5c679241175baf085e3257">cgv::gui::VRE_ONE_AXIS</a></div><div class="ttdeci">@ VRE_ONE_AXIS</div><div class="ttdoc">trigger / throttle / pedal events</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00032">vr_server.h:32</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cdaa52da604bb760364d15d1f271264ccf5"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdaa52da604bb760364d15d1f271264ccf5">cgv::gui::VRE_KEY</a></div><div class="ttdeci">@ VRE_KEY</div><div class="ttdoc">key events</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00031">vr_server.h:31</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cdab531b503b809c0b17a03c7eb34ba8500"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdab531b503b809c0b17a03c7eb34ba8500">cgv::gui::VRE_STATUS</a></div><div class="ttdeci">@ VRE_STATUS</div><div class="ttdoc">status change events</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00030">vr_server.h:30</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cdabc2660a06e4491252aa2ae75b2d5aad8"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdabc2660a06e4491252aa2ae75b2d5aad8">cgv::gui::VRE_TWO_AXES_GENERATES_DPAD</a></div><div class="ttdeci">@ VRE_TWO_AXES_GENERATES_DPAD</div><div class="ttdoc">whether two axes input generates direction pad keys when presses</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00035">vr_server.h:35</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_adf175441c50e1ab96818ddaf9fb700cdad51d9f77f004dc9dba700ed831a2b135"><div class="ttname"><a href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdad51d9f77f004dc9dba700ed831a2b135">cgv::gui::VRE_DEVICE</a></div><div class="ttdeci">@ VRE_DEVICE</div><div class="ttdoc">device change events</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8h_source.html#l00029">vr_server.h:29</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_ae0975ed87d1a75c654c88184288a6543"><div class="ttname"><a href="namespacecgv_1_1gui.html#ae0975ed87d1a75c654c88184288a6543">cgv::gui::connect_vr_server</a></div><div class="ttdeci">void connect_vr_server(bool connect_device_change_only_to_animation_trigger, cgv::gui::window_ptr w)</div><div class="ttdoc">connect the gamepad server to the given window or the first window of the application,...</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8cxx_source.html#l00414">vr_server.cxx:414</a></div></div>
</div><!-- fragment --><p>For the includes you need to add the following include paths in your .pj file: </p><pre class="fragment">addIncDirs=[INPUT_DIR, CGV_DIR."/libs", CGV_DIR."/test"];
</pre><p> If you have enabled the device (<a class="el" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdad51d9f77f004dc9dba700ed831a2b135" title="device change events">cgv::gui::VRE_DEVICE</a>) and status (<a class="el" href="namespacecgv_1_1gui.html#adf175441c50e1ab96818ddaf9fb700cdab531b503b809c0b17a03c7eb34ba8500" title="status change events">cgv::gui::VRE_STATUS</a>) events, you can set special callbacks to get informed of device changes and changes of the tracking and attachement status of hmds, controllers and trackers. This can already be prepared in your constructor: </p><div class="fragment"><div class="line">{c++}</div>
<div class="line">   connect(<a class="code" href="namespacecgv_1_1gui.html#a6258ed6030a5c4d826fc85aeb2557035">cgv::gui::ref_vr_server</a>().on_device_change, <span class="keyword">this</span>, &amp;<a class="code" href="classvr__test.html#ab02820236fe297208111aa3711ac054b">vr_test::on_device_change</a>);</div>
<div class="line">   connect(<a class="code" href="namespacecgv_1_1gui.html#a6258ed6030a5c4d826fc85aeb2557035">cgv::gui::ref_vr_server</a>().on_status_change, <span class="keyword">this</span>, &amp;<a class="code" href="classvr__test.html#a7eae82fa7338d386cbfc9c6b8f87489e">vr_test::on_status_change</a>);</div>
<div class="ttc" id="aclassvr__test_html_a7eae82fa7338d386cbfc9c6b8f87489e"><div class="ttname"><a href="classvr__test.html#a7eae82fa7338d386cbfc9c6b8f87489e">vr_test::on_status_change</a></div><div class="ttdeci">void on_status_change(void *kit_handle, int ci, vr::VRStatus old_status, vr::VRStatus new_status)</div><div class="ttdoc">keep track of status changes</div><div class="ttdef"><b>Definition:</b> <a href="vr__test_8cxx_source.html#l00107">vr_test.cxx:107</a></div></div>
<div class="ttc" id="aclassvr__test_html_ab02820236fe297208111aa3711ac054b"><div class="ttname"><a href="classvr__test.html#ab02820236fe297208111aa3711ac054b">vr_test::on_device_change</a></div><div class="ttdeci">void on_device_change(void *kit_handle, bool attach)</div><div class="ttdoc">register on device change events</div><div class="ttdef"><b>Definition:</b> <a href="vr__test_8cxx_source.html#l00128">vr_test.cxx:128</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_a6258ed6030a5c4d826fc85aeb2557035"><div class="ttname"><a href="namespacecgv_1_1gui.html#a6258ed6030a5c4d826fc85aeb2557035">cgv::gui::ref_vr_server</a></div><div class="ttdeci">vr_server &amp; ref_vr_server()</div><div class="ttdoc">return a reference to gamepad server singleton</div><div class="ttdef"><b>Definition:</b> <a href="vr__server_8cxx_source.html#l00397">vr_server.cxx:397</a></div></div>
</div><!-- fragment --><p>These callbacks are implemented like this: </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vr__driver_8h.html">vr/vr_driver.h</a>&gt;</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classvr__test.html#ab02820236fe297208111aa3711ac054b">vr_test::on_device_change</a>(<span class="keywordtype">void</span>* kit_handle, <span class="keywordtype">bool</span> attach)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (attach) {</div>
<div class="line">        <a class="code" href="classvr_1_1vr__kit.html">vr::vr_kit</a>* kit_ptr = <a class="code" href="namespacevr.html#a3420569d66aab89ad53aa8ee86f76733">vr::get_vr_kit</a>(kit_handle);</div>
<div class="line">        :</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classvr__test.html#a7eae82fa7338d386cbfc9c6b8f87489e">vr_test::on_status_change</a>(<span class="keywordtype">void</span>* kit_handle, <span class="keywordtype">int</span> ci, <a class="code" href="namespacevr.html#a97f62fa341bd860ba107738084e5cc08">vr::VRStatus</a> old_status, <a class="code" href="namespacevr.html#a97f62fa341bd860ba107738084e5cc08">vr::VRStatus</a> new_status)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classvr_1_1vr__kit.html">vr::vr_kit</a>* kit_ptr = <a class="code" href="namespacevr.html#a3420569d66aab89ad53aa8ee86f76733">vr::get_vr_kit</a>(kit_handle);</div>
<div class="line">    :</div>
<div class="line">}</div>
<div class="ttc" id="aclassvr_1_1vr__kit_html"><div class="ttname"><a href="classvr_1_1vr__kit.html">vr::vr_kit</a></div><div class="ttdoc">a vr kit is composed of headset, two controllers, and two trackers, where all devices can be attached...</div><div class="ttdef"><b>Definition:</b> <a href="vr__kit_8h_source.html#l00068">vr_kit.h:69</a></div></div>
<div class="ttc" id="anamespacevr_html_a3420569d66aab89ad53aa8ee86f76733"><div class="ttname"><a href="namespacevr.html#a3420569d66aab89ad53aa8ee86f76733">vr::get_vr_kit</a></div><div class="ttdeci">vr_kit * get_vr_kit(void *handle)</div><div class="ttdoc">query a pointer to a vr kit by its device handle, function can return null pointer in case that no vr...</div><div class="ttdef"><b>Definition:</b> <a href="vr__driver_8cxx_source.html#l00212">vr_driver.cxx:212</a></div></div>
<div class="ttc" id="anamespacevr_html_a97f62fa341bd860ba107738084e5cc08"><div class="ttname"><a href="namespacevr.html#a97f62fa341bd860ba107738084e5cc08">vr::VRStatus</a></div><div class="ttdeci">VRStatus</div><div class="ttdoc">different status values for a trackable</div><div class="ttdef"><b>Definition:</b> <a href="vr__state_8h_source.html#l00084">vr_state.h:85</a></div></div>
<div class="ttc" id="avr__driver_8h_html"><div class="ttname"><a href="vr__driver_8h.html">vr_driver.h</a></div><div class="ttdoc">defines the class vr::vr_driver class and gives access to the driver registry with the functions vr::...</div></div>
</div><!-- fragment --><p>The vr events are dispatched through your handle method and where you can ensure that you only process vr events by </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="classvr__test.html#accca3956f28dc94379ebcac0a7b41f53">vr_test::handle</a>(<a class="code" href="classcgv_1_1gui_1_1event.html">cgv::gui::event</a>&amp; e)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> ((e.<a class="code" href="classcgv_1_1gui_1_1event.html#aab1416286305286b19ebfccc165abf67">get_flags</a>() &amp; <a class="code" href="namespacecgv_1_1gui.html#ae38dbc5a70de43f0304bf39dcf21175aa62bd9726fe3f52c40bade752ad5451c8">cgv::gui::EF_VR</a>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    :</div>
<div class="line">}</div>
<div class="ttc" id="aclasscgv_1_1gui_1_1event_html"><div class="ttname"><a href="classcgv_1_1gui_1_1event.html">cgv::gui::event</a></div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00058">event.h:59</a></div></div>
<div class="ttc" id="aclasscgv_1_1gui_1_1event_html_aab1416286305286b19ebfccc165abf67"><div class="ttname"><a href="classcgv_1_1gui_1_1event.html#aab1416286305286b19ebfccc165abf67">cgv::gui::event::get_flags</a></div><div class="ttdeci">unsigned get_flags() const</div><div class="ttdoc">return the event flags</div><div class="ttdef"><b>Definition:</b> <a href="event_8cxx_source.html#l00214">event.cxx:214</a></div></div>
<div class="ttc" id="aclassvr__test_html_accca3956f28dc94379ebcac0a7b41f53"><div class="ttname"><a href="classvr__test.html#accca3956f28dc94379ebcac0a7b41f53">vr_test::handle</a></div><div class="ttdeci">bool handle(cgv::gui::event &amp;e)</div><div class="ttdoc">overload and implement this method to handle events</div><div class="ttdef"><b>Definition:</b> <a href="vr__test_8cxx_source.html#l00328">vr_test.cxx:328</a></div></div>
<div class="ttc" id="anamespacecgv_1_1gui_html_ae38dbc5a70de43f0304bf39dcf21175aa62bd9726fe3f52c40bade752ad5451c8"><div class="ttname"><a href="namespacecgv_1_1gui.html#ae38dbc5a70de43f0304bf39dcf21175aa62bd9726fe3f52c40bade752ad5451c8">cgv::gui::EF_VR</a></div><div class="ttdeci">@ EF_VR</div><div class="ttdoc">whether event is from VR kit</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00035">event.h:35</a></div></div>
</div><!-- fragment --><p>For examples of how to process vr events please checkout <b><code>&lt;<a class="el" href="vr__test_8cxx_source.html">cgv/plugins/vr_test/vr_test.cxx</a>&gt;</code></b>.</p>
<h1><a class="anchor" id="VRInfo"></a>
Device Information</h1>
<p>To get device information of the vr kit and its attached controllers and trackers, the <a class="el" href="classvr_1_1vr__kit.html" title="a vr kit is composed of headset, two controllers, and two trackers, where all devices can be attached...">vr::vr_kit</a> class provides the <a class="el" href="classvr_1_1vr__kit.html#a618d2f0e426c259410816d1c659f51cf" title="return information on the currently attached devices">vr::vr_kit::get_device_info()</a> function that stores all static device information. The information on controllers and trackers is filled when they are attached, what can change during program execution. Information on not attached controllers and trackers might be invalid. The attachment status can be tracked in the status events and is also accessible in all vr events through the get_state() function, e.g. <a class="el" href="classcgv_1_1gui_1_1vr__event__extension.html#a090914a6410fa94f2c49178d83641d24" title="return the state of vr kit">cgv::gui::vr_key_event::get_state()</a>. When browsing the documentation on the <a class="el" href="structvr_1_1vr__kit__info.html" title="information provided for a vr kit">vr::vr_kit_info</a> class, always check also the inheritance hierarchy as for example the serial number is available for all derived device classes from the <a class="el" href="structvr_1_1vr__device__info.html" title="information provided for any device type">vr::vr_device_info</a> class. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
