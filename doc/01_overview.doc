// This file is for Doxygen input. It is not compiled.

using namespace cgv;

/*! \page overview The Computer Graphics and Visualization Framework

\section cgv Basics

The framework consists of several base libraries with the prefix cgv, a standard cgv_viewer and
several plugins that can be loaded when starting the viewer by specifying them
in the command line arguments. All plugin interfaces and the registration is
handled by the cgv libraries.

The cgv libraries are
- cgv_os ... basic operating system support (threads, sockets)
- cgv_utils ... helps to work with files and text
- cgv_type (cgv_utils) ... standardized type declaration and type reflection support
- cgv_data (cgv_type/utils) ... data management such as smart pointers and data views
- cgv_base (cgv_data/type/utils) ... registration mechanism, communication and hierarchical structures
- cgv_math (cgv_base/type/utils) ... large collection of mostly templated math functions and solvers
- cgv_media (cgv_base/data/type/utils) ... support for fonts, images, video and 3D data
- cgv_gui (cgv_media/base/data/type/utils) ... abstraction of gui
- cgv_render (cgv_gui/media/base/data/type/utils) ... rendering support with OpenGL specialization

Deprecated is the cgv library that includes all of the above components in one library.


\section platforms Supported Platforms

Currently the following system configurations are supported
- Windows XP / Vista
  - Microsoft Visual Studio
    - Visual Studio 2005 (abbreviated by vs8)
    - Visual Studio 2008 (abbreviated by vs9)
    - Visual Studio 2008 Express (abbreviated by vs9e)
    - Visual Studio 2010 (abbreviated by vs10)
- Linux
  - gcc is in preparation

Under windows all compilers can be used at the same time. The
postfix "_8", "_9", "_9e", "_10" is used for applications and libraries to distinguish
the versions. For example "cgv_viewer_8.exe" loads "cgv_8.dll" and "cgv_viewer_9.exe"
loads "cgv_9.dll" on startup.
  
\section configs Configurations

For building libraries and viewer there are four configurations, which are 
distinguished by extending the compiler postfix. In the following list the
cgv internal name of the configuration is given followed by configuration
name in vs9 and the full name of the cgv dll with all postfixes that
are used in the same way for all other libraries and applications
- shared release (Release Dll) cgv_9.dll
- shared debug (Debug Dll) cgv_d9.dll
- static release (Release) cgv_s9.dll
- static debug (Debug) cgv_ds9.dll

\section plugins Plugins

A plugin can register instances or factories of newly implemented classes. 
The new classes are derived from interface class declared in the cgv libraries
as for example cgv::render::drawable. Registration is typically done in the 
constructor of a static dummy variable of special template types that do nothing
else but register an object or a factory. When the plugin is compiled to a dll
the registration code is executed when the dll is loaded.

\section directories Directory Tree

The framework is managed in a svn repository located at
https://cgv.inf.tu-dresden.de/svn/cgv/release . It consists of the following tree of 
sub directories:
- 3rd ... 3rd party libraries conditioned for the cgv framework currently 
including fltk, libjpeg, libpng, libtiff, zlib and headers for some microsoft
specific COM APIs.
- apps ... applications currently including the cgv_viewer and tools for 
the compilation: res_prep (conversion of resource files into source files),
soon also ppp (preprocessing of header files and makefile generation)
- bin ... binaries and scripts (ppp, generate_makefile)
- cgv ... the core library
  - base ... basic class hierarchy, support for plugin framework, basic communication
             classes for signals and rebinding of functions
  - config ... configuration for ppp and different platforms
  - data ... data management like ref_ptr and formated data
  - defines ... basic helpers for macro programming
  - gui ... abstracted gui framework based on a driver concept. Currently, only a fltk
            driver is available in the plugin cg_fltk.
  - math ... template classes for math, mostly linear algebra 
  - media ... support for different media types
    - font
    - image
    - video
    - text
  - render ... abstracted interface for GPU programming
    - gl ... OpenGL specific implementations
  - type ... support for compile time information about types
  - utils ... some further utility functions and class that don't fit somewhere else like
              file handling and statistics.
- doc ... documentation source files
- lib ... precompiled libraries (fltk)
- make ... makefiles, currently only for vs8 and vs9. It is planed to have a 
makefile generation facility based on ppp soon, that replaces all current
makefiles.
- plugins ... commonly used plugins
  - cg_fltk ... plugin that implements the abstract gui framework
  - cmi_io ... support for image io
  - crg_view ... provides mouse interaction for the opengl view in the cgv_viewer
  - crg_planar_view ... variant of crg_view where only 2d navigation is possible
  - crg_spherical_view ... variant of crg_view with a spherical coordinate system
  - examples ... different example classes that illustrate the cgv framework
- test ... test sources for different parts of the framework that also serve as examples

\section viewer Usage of the cgv_viewer

The cgv_viewer can load plugins after start up. It parses the command line arguments
with the help of the function cgv::base::process_command_line_args declared in the
header cgv/base/register.h. This function simply calls the cgv::base::process_command
function for each argument. The command syntax is explained in the documentation of this
function.

A plugin can register objects, object factories and registration listeners. Object and
factory registration events are delayed until all plugins have been read. Then all registration
events are sent to all registered listeners, such that the order in which the plugins are
read is not important.

After startup the viewer provides a main menu that can be extended by the plugins, a 3d view
and a tab group with guis for registered object instances, which is only shown if there is at
least one registered object instance that provides a gui. 

In the main menu the
item "new" is meant for entries of factories that create new object instances. A factory
can be tagged singelton, in which case only one instance can be created. There is also
a shortcut assigned to each factory, for example <Ctrl-Q>. If pressed, a new object instance
is created. In case of a singelton factory, pressing the shortcut again will toggle visibility
of the object instance in the 3d view and select its gui in the tab group of guis.

\section configFiles Configuration Files

The registration facility and the property interface of the cgv framework as described
on page \ref baseNS is exploited to support configuration files. A configuration file
is passed to the viewer with the command syntax config:"file_name". The use of quotes is
important when the file path contains spaces. To add the config command line
argument in a project file use the \c addCommandLineArgs define (see \ref makegen).

Config files are user specific and should therefore not be checked into the svn repository.
Therefore, a twofold strategy is realized based on a default config file and a user specific.
The default file is checked into the svn repository and has the extension \c ".def". It will be 
specified in -c config:-commands to the viewer and is always available from the svn 
repository. The user can copy the default file into a file with the same name but the extension 
\c ".cfg" and specify his user specific configuration there. The viewer will first check for
the existence of the \c ".cfg" file and if present read this instead of the default file.

The syntax of the config file is very simple. Lines that start with a \c '/' are comments.
Empty lines are ignored. Lines that contain configuration information are processed with the
cgv::base::process_command function. Let us explain the most important commands with a simple 
example config file
\code
/ this is a comment
show all

name(cgv 3d viewer):x=4;y=30;w=1024;h=768
type(graphical_text_interpreter):x=1032;y=30;w=592;h=768
name(gti):file_name="D:\Projects\project\gti\examples\examples.dcr"

persistent
name(stereo interactor):view_dir_x=?;view_dir_y=?;view_dir_z=?

initial
name(stereo interactor):extent=2
\endcode

There are two possibilities to address registered objects in a config file:
- by name ... with the syntax \c name(gti) followed by a colon. This is supported
              only for objects derived from cgv::base::named and the name is matches
              against cgv::base::named::get_name().
- by type ... with the syntax \c type(graphical_text_interpreter) followed by a colon.
              This makes sense only for singleton objects. The type is matched
              against cgv::base::base::get_type_name().
The rest of each line after the colon, a semicolon separated list of member assignments 
follows. This is passed to the cgv::base::base::multi_set() method. Strings can be enclosed
with single or double quotes. If a quote is part of the string, one can use the backslash as 
escape character. A backslash is either referenced by a double backslash inside a quoted string
or if not followed by the enclosing quote symbol, also by a single backslash - as for example in
the file name assignment in the above sample.

There are two modes to set members of registered objects in the config file:
- initial ... the value is set once when the config file is read 
- persistent ... the value is set when the config file is read and the config file is
                 updated whenever the value is changed. This allows to make the current 
                 values of selected members persistent over several runs of the application.
                 Only members that are reflected inside the cgv::base::self_reflect method
                 are supported for persistent configuration.
At the beginning of a config file the default mode is \c initial. The special config file lines
\c persistent and \c initial change the mode for the successive entries of the config file.
When a member is configured persistently and the question mark \c ? is assigned to a member,
the initial value set by the application is kept and written to the config file after the first
run of the application.

The line \c "show all" is a special command that will cause the viewer
to print out all registered objects and their properties to the console window.
In this way one can find out all objects that can be configured.
*/